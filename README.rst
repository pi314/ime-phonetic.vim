===============================================================================
ime-phonetic.vim
===============================================================================
ime-phonetic.vim 是 `ime.vim <https://github.com/pi314/ime.vim>`_ 的 standalone 套件。


安裝
-------------------------------------------------------------------------------
安裝此 plugin 以後，請在 ``g:ime_plugins`` 裡面加上 ``'phonetic'`` ： ::

  let g:ime_plugins = ['phonetic']


使用
-------------------------------------------------------------------------------
* 關閉系統的注音輸入法，直接輸入注音，注音符號會直接出現在編輯區中
* 選字

  - 若使用方向鍵（ ``<Up>`` / ``<Down>`` ）選詞，按下 Enter（ ``<CR>`` ）即可選字
  - 若使用 ``<C-n>`` / ``<C-p>`` 選詞則不需要再按其他按鍵

* 按下 ``'`` 可以從第一個字開始選字，不會做任何的詞語搜尋
* 如果輸入了完全正確的注音詞彙，而且該詞彙只有一種可能，套件會自動把該詞彙送至第一順位。
* 支援基本的模糊拼音， ``ㄏㄉ`` 可以產生 ``互動``
* 按下 ``;;`` 以後，可進入標點符號模式

  - 按下 ``,`` 可輸入 ``，``
  - 按下 ``.`` 可輸入 ``。``
  - 按下 ``:`` 可輸入 ``：``
  - 輸出標點符號以後會自動回到注音中文模式


設定
-------------------------------------------------------------------------------
* 設定快取的大小::

    let g:ime_phonetic_cache_size = 1000

  - ime-phonetic.vim 會對先前搜尋過的詞句做快取，以加速詞句搜尋

* 自訂詞庫::

    let g:ime_phonetic_custom_table = '~/.phonetic.table'

  - 此設定沒有預設值，請在需要時自行設定
  - 詞庫檔案的格式為::

      不要 1j6ul4
      哇呼 j84cj
      #這是註解

本套件仍然在開發中，有一些已知的問題，若發現問題或是有開發想法，歡迎開 issue。


詞庫
-------------------------------------------------------------------------------
ime-phonetic.vim 的詞庫是由為 MIT License 授權的 `小麥注音 <https://mcbopomofo.openvanilla.org/>`_ 轉換而來

轉換的 Makefile/script 在 `這裡 <https://github.com/pi314/phonetic-table>`_


實作細節
-------------------------------------------------------------------------------
在 ime-phonetic.vim 之中，最關鍵的幾個演算法是注音符號切割、選字選詞與快取。


注音符號切割
*******************************************************************************
使用者輸入了一串注音符號以後，這些符號需要先分組，每組的注音才能形成文字。

ime-phonetic.vim 把
`所有的注音組合 <https://zh.wiktionary.org/zh-hant/附录:注音索引>`_ 用 tree 的方式儲存在 VimScript，
tree 則是用 dict 實作，leaves 用 ``"_"`` 表示。

使用者輸入的注音符號串依序被拿出來，從這棵 tree 的 root 開始往下走；
每走一步，就把該符號收集起來；若已經沒有 node 可以走，就把收集好的符號組成一組，下一個符號從 root 開始走。


選字選詞與快取
*******************************************************************************
在注音符號被分組成讀音以後，這些讀音需要選字選詞才能形成句字。

ime-phonetic.vim 使用了 Dynamic Programming，搭配詞庫中的詞頻來選詞。

這個方式類似 `木條切割問題 <https://en.wikipedia.org/wiki/Cutting_stock_problem>`_ 。

不同之處在於，ime-phonetic 使用了 dict 而不是 2D array 來儲存 DP 的過程。

即使選詞已經完成，這個 DP 過程不會也被丟棄；它會被保留以加速下次的選字選詞。


授權
-------------------------------------------------------------------------------
本軟體使用 2-clause BSD license 發佈，請參考 LICENSE.txt
